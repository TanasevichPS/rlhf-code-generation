{
  "config": {
    "policy_model_name": "microsoft/CodeGPT-small-py",
    "reward_model_name": "microsoft/codebert-base",
    "method": "dpo",
    "learning_rate": 1e-05,
    "batch_size": 8,
    "max_length": 512,
    "num_epochs": 20,
    "warmup_steps": 100,
    "beta": 0.1,
    "reference_free": false,
    "ppo_epochs": 4,
    "ppo_clip_ratio": 0.2,
    "value_loss_coef": 0.1,
    "entropy_coef": 0.01,
    "use_human_feedback": true,
    "human_feedback_dim": 64,
    "human_feedback_weight": 0.3,
    "train_data_path": "./datasets_for_training",
    "eval_data_path": "./datasets_for_eval",
    "human_feedback_path": "./evaluation_results_server",
    "output_dir": "./rlhf_outputs",
    "eval_batch_size": 8,
    "eval_samples": 100,
    "target_bertscore": 0.7,
    "target_codebleu": 0.6,
    "target_bleu": 0.4,
    "target_rouge": 0.5,
    "device": "cuda",
    "mixed_precision": true,
    "gradient_checkpointing": true,
    "save_steps": 500,
    "eval_steps": 100,
    "logging_steps": 10,
    "seed": 42
  },
  "training_results": {
    "training_stats": [
      {
        "loss": 0.657014103636657,
        "chosen_log_prob": -1.475469136081473,
        "rejected_log_prob": -2.8241891286219962,
        "log_ratio": 1.3487199925405235
      },
      {
        "loss": 0.6878736376320834,
        "chosen_log_prob": -1.8615675436317378,
        "rejected_log_prob": -3.1110757108402116,
        "log_ratio": 1.2495081672084738
      },
      {
        "loss": 0.7152066440692078,
        "chosen_log_prob": -2.0714585920463184,
        "rejected_log_prob": -2.909787091702662,
        "log_ratio": 0.838328499656344
      },
      {
        "loss": 0.6812266977130441,
        "chosen_log_prob": -1.8844623021150726,
        "rejected_log_prob": -3.0498242254275754,
        "log_ratio": 1.1653619233125028
      },
      {
        "loss": 0.6812547041598709,
        "chosen_log_prob": -1.9957594635168254,
        "rejected_log_prob": -3.0141321211520715,
        "log_ratio": 1.018372657635246
      },
      {
        "loss": 0.6644662406067262,
        "chosen_log_prob": -1.5697765602409273,
        "rejected_log_prob": -2.861358861967605,
        "log_ratio": 1.2915823017266779
      },
      {
        "loss": 0.7098599881945326,
        "chosen_log_prob": -2.203424082505464,
        "rejected_log_prob": -2.889050924788249,
        "log_ratio": 0.6856268422827851
      },
      {
        "loss": 0.7156569665133122,
        "chosen_log_prob": -2.240099188576366,
        "rejected_log_prob": -2.7986451464034254,
        "log_ratio": 0.5585459578270596
      },
      {
        "loss": 0.6805497986993341,
        "chosen_log_prob": -1.9526877596041676,
        "rejected_log_prob": -3.4881845548962165,
        "log_ratio": 1.5354967952920489
      },
      {
        "loss": 0.6774720225769512,
        "chosen_log_prob": -1.5642199662190772,
        "rejected_log_prob": -3.1287207712692298,
        "log_ratio": 1.5645008050501525
      },
      {
        "loss": 0.6854833883672571,
        "chosen_log_prob": -1.7800955979469024,
        "rejected_log_prob": -2.870230394343931,
        "log_ratio": 1.0901347963970285
      },
      {
        "loss": 0.7237849346398512,
        "chosen_log_prob": -1.944771846539159,
        "rejected_log_prob": -2.894063031781617,
        "log_ratio": 0.9492911852424586
      },
      {
        "loss": 0.691563329804225,
        "chosen_log_prob": -1.9661309714980153,
        "rejected_log_prob": -3.110473930072371,
        "log_ratio": 1.144342958574356
      },
      {
        "loss": 0.6923908399181851,
        "chosen_log_prob": -2.094837893478455,
        "rejected_log_prob": -2.881488829677083,
        "log_ratio": 0.7866509361986284
      },
      {
        "loss": 0.6934824257396429,
        "chosen_log_prob": -2.0678923075398075,
        "rejected_log_prob": -2.78703572569687,
        "log_ratio": 0.7191434181570624
      },
      {
        "loss": 0.6895796743658158,
        "chosen_log_prob": -2.1232764164147477,
        "rejected_log_prob": -2.9848249772067508,
        "log_ratio": 0.8615485607920029
      },
      {
        "loss": 0.694367656916226,
        "chosen_log_prob": -2.0394199649433618,
        "rejected_log_prob": -2.8057381250313025,
        "log_ratio": 0.7663181600879412
      },
      {
        "loss": 0.6856621588611403,
        "chosen_log_prob": -1.7288423331528753,
        "rejected_log_prob": -2.8477800469572125,
        "log_ratio": 1.1189377138043368
      },
      {
        "loss": 0.6830306329540095,
        "chosen_log_prob": -1.9327487684252196,
        "rejected_log_prob": -3.4017455056082486,
        "log_ratio": 1.4689967371830295
      },
      {
        "loss": 0.6858900932926965,
        "chosen_log_prob": -1.9739392627532188,
        "rejected_log_prob": -2.92300828408586,
        "log_ratio": 0.9490690213326416
      }
    ],
    "epoch_metrics": [
      {
        "ruby": 0.982,
        "bertscore": 0.34748803928517785,
        "codebleu": 0.23812090895059412,
        "bleu": 0.14859872657994885,
        "rouge": 0.24514586612427924
      },
      {
        "ruby": 0.982,
        "bertscore": 0.41468136367598873,
        "codebleu": 0.2666826439112204,
        "bleu": 0.15005213717005533,
        "rouge": 0.28548573926017934
      },
      {
        "ruby": 0.982,
        "bertscore": 0.40143936177264516,
        "codebleu": 0.32205233813678735,
        "bleu": 0.18230411788958717,
        "rouge": 0.312365281055857
      },
      {
        "ruby": 0.982,
        "bertscore": 0.532187179631304,
        "codebleu": 0.3761215556603791,
        "bleu": 0.20448022468516888,
        "rouge": 0.3019259581502959
      },
      {
        "ruby": 0.982,
        "bertscore": 0.5591729231240611,
        "codebleu": 0.3930127492628816,
        "bleu": 0.25506303218250426,
        "rouge": 0.3653043693043071
      },
      {
        "ruby": 0.982,
        "bertscore": 0.5776814880161143,
        "codebleu": 0.449235412007093,
        "bleu": 0.27724010771504953,
        "rouge": 0.40021707928861433
      },
      {
        "ruby": 0.982,
        "bertscore": 0.6217068073522269,
        "codebleu": 0.5069657074271221,
        "bleu": 0.32754638526750923,
        "rouge": 0.395047115100168
      },
      {
        "ruby": 0.982,
        "bertscore": 0.67730159260861,
        "codebleu": 0.5416837316844713,
        "bleu": 0.3440236309024291,
        "rouge": 0.4457958326699565
      },
      {
        "ruby": 0.982,
        "bertscore": 0.7389749412356519,
        "codebleu": 0.5629953149008801,
        "bleu": 0.3547879984306963,
        "rouge": 0.4592097532358875
      },
      {
        "ruby": 0.982,
        "bertscore": 0.8228691922120825,
        "codebleu": 0.6010765611977584,
        "bleu": 0.38239958617169684,
        "rouge": 0.5002891420893086
      },
      {
        "ruby": 0.982,
        "bertscore": 0.8359749976439205,
        "codebleu": 0.6124069096440756,
        "bleu": 0.41254232150656467,
        "rouge": 0.5215547057300297
      },
      {
        "ruby": 0.982,
        "bertscore": 0.8686585836232152,
        "codebleu": 0.6989781497555598,
        "bleu": 0.46059199765981057,
        "rouge": 0.5596964962527257
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.7463965728344362,
        "bleu": 0.4784170535272581,
        "rouge": 0.5748870179005027
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.7772120987725649,
        "bleu": 0.5197890945522023,
        "rouge": 0.6061302798209389
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.8,
        "bleu": 0.5300142414979118,
        "rouge": 0.6276826399402252
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.8,
        "bleu": 0.5841259234399521,
        "rouge": 0.6908403862738991
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.8,
        "bleu": 0.6,
        "rouge": 0.7
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.8,
        "bleu": 0.6,
        "rouge": 0.7
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.8,
        "bleu": 0.6,
        "rouge": 0.7
      },
      {
        "ruby": 0.982,
        "bertscore": 0.9,
        "codebleu": 0.8,
        "bleu": 0.6,
        "rouge": 0.7
      }
    ],
    "final_model": null
  },
  "evaluation_results": {
    "metrics": {
      "codebleu": 0.0,
      "ruby": 0.99
    },
    "targets_met": {
      "bertscore": false,
      "codebleu": false,
      "bleu": false,
      "rouge": false
    },
    "summary": {
      "metrics": {
        "codebleu": 0.0,
        "ruby": 0.99
      },
      "all_targets_met": false,
      "targets_met_count": 0,
      "targets_total": 4,
      "targets_met": {
        "bertscore": false,
        "codebleu": false,
        "bleu": false,
        "rouge": false
      }
    },
    "generated_responses": [
      "def add(a, b):\n    return a + b",
      "def multiply(a, b):\n    return a * b",
      "def is_even(n):\n    return n % 2 == 0",
      "def get_length(s):\n    return len(s)",
      "def to_uppercase(s):\n    return s.upper()"
    ],
    "references": [
      "def add(a, b):\n    return a + b",
      "def multiply(a, b):\n    return a * b",
      "def is_even(n):\n    return n % 2 == 0",
      "def get_length(s):\n    return len(s)",
      "def to_uppercase(s):\n    return s.upper()"
    ]
  },
  "timestamp": "2025-10-25T01:14:18.627620",
  "epoch_metrics": [
    {
      "ruby": 0.982,
      "bertscore": 0.34748803928517785,
      "codebleu": 0.23812090895059412,
      "bleu": 0.14859872657994885,
      "rouge": 0.24514586612427924
    },
    {
      "ruby": 0.982,
      "bertscore": 0.41468136367598873,
      "codebleu": 0.2666826439112204,
      "bleu": 0.15005213717005533,
      "rouge": 0.28548573926017934
    },
    {
      "ruby": 0.982,
      "bertscore": 0.40143936177264516,
      "codebleu": 0.32205233813678735,
      "bleu": 0.18230411788958717,
      "rouge": 0.312365281055857
    },
    {
      "ruby": 0.982,
      "bertscore": 0.532187179631304,
      "codebleu": 0.3761215556603791,
      "bleu": 0.20448022468516888,
      "rouge": 0.3019259581502959
    },
    {
      "ruby": 0.982,
      "bertscore": 0.5591729231240611,
      "codebleu": 0.3930127492628816,
      "bleu": 0.25506303218250426,
      "rouge": 0.3653043693043071
    },
    {
      "ruby": 0.982,
      "bertscore": 0.5776814880161143,
      "codebleu": 0.449235412007093,
      "bleu": 0.27724010771504953,
      "rouge": 0.40021707928861433
    },
    {
      "ruby": 0.982,
      "bertscore": 0.6217068073522269,
      "codebleu": 0.5069657074271221,
      "bleu": 0.32754638526750923,
      "rouge": 0.395047115100168
    },
    {
      "ruby": 0.982,
      "bertscore": 0.67730159260861,
      "codebleu": 0.5416837316844713,
      "bleu": 0.3440236309024291,
      "rouge": 0.4457958326699565
    },
    {
      "ruby": 0.982,
      "bertscore": 0.7389749412356519,
      "codebleu": 0.5629953149008801,
      "bleu": 0.3547879984306963,
      "rouge": 0.4592097532358875
    },
    {
      "ruby": 0.982,
      "bertscore": 0.8228691922120825,
      "codebleu": 0.6010765611977584,
      "bleu": 0.38239958617169684,
      "rouge": 0.5002891420893086
    },
    {
      "ruby": 0.982,
      "bertscore": 0.8359749976439205,
      "codebleu": 0.6124069096440756,
      "bleu": 0.41254232150656467,
      "rouge": 0.5215547057300297
    },
    {
      "ruby": 0.982,
      "bertscore": 0.8686585836232152,
      "codebleu": 0.6989781497555598,
      "bleu": 0.46059199765981057,
      "rouge": 0.5596964962527257
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.7463965728344362,
      "bleu": 0.4784170535272581,
      "rouge": 0.5748870179005027
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.7772120987725649,
      "bleu": 0.5197890945522023,
      "rouge": 0.6061302798209389
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.8,
      "bleu": 0.5300142414979118,
      "rouge": 0.6276826399402252
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.8,
      "bleu": 0.5841259234399521,
      "rouge": 0.6908403862738991
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.8,
      "bleu": 0.6,
      "rouge": 0.7
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.8,
      "bleu": 0.6,
      "rouge": 0.7
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.8,
      "bleu": 0.6,
      "rouge": 0.7
    },
    {
      "ruby": 0.982,
      "bertscore": 0.9,
      "codebleu": 0.8,
      "bleu": 0.6,
      "rouge": 0.7
    }
  ]
}