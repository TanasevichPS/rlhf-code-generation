{
  "config": {
    "model": {
      "base_model_name": "microsoft/CodeGPT-small-py",
      "reward_model_name": "microsoft/codebert-base",
      "policy_model_size": "small",
      "reward_model_size": "base",
      "trust_remote_code": true,
      "use_fast_tokenizer": true,
      "torch_dtype": "float32",
      "max_position_embeddings": 1024,
      "hidden_size": 768,
      "num_attention_heads": 12,
      "num_hidden_layers": 12
    },
    "training": {
      "learning_rate": 1e-05,
      "batch_size": 4,
      "gradient_accumulation_steps": 4,
      "max_grad_norm": 1.0,
      "ppo_epochs": 3,
      "ppo_clip_ratio": 0.2,
      "ppo_value_loss_coef": 0.1,
      "ppo_entropy_coef": 0.01,
      "ppo_kl_penalty": 0.02,
      "dpo_beta": 0.1,
      "dpo_loss_type": "sigmoid",
      "warmup_steps": 100,
      "total_steps": 500,
      "save_steps": 500,
      "eval_steps": 100,
      "logging_steps": 10,
      "early_stopping_patience": 3,
      "early_stopping_threshold": 0.01
    },
    "generation": {
      "max_new_tokens": 256,
      "temperature": 0.7,
      "top_p": 0.9,
      "top_k": 50,
      "repetition_penalty": 1.1,
      "do_sample": true,
      "max_prompt_length": 512,
      "max_response_length": 512,
      "min_code_length": 10,
      "num_beams": 1,
      "num_return_sequences": 1,
      "early_stopping": true
    },
    "reward": {
      "reward_learning_rate": 2e-05,
      "reward_batch_size": 8,
      "reward_epochs": 3,
      "human_feedback_weight": 0.3,
      "use_human_logits": true,
      "human_logits_layer": "last",
      "syntax_reward_weight": 0.2,
      "execution_reward_weight": 0.3,
      "semantic_reward_weight": 0.3,
      "human_preference_weight": 0.2,
      "reward_normalization": true,
      "reward_clipping": true,
      "reward_clip_value": 5.0
    },
    "evaluation": {
      "target_bertscore": 0.7,
      "target_codebleu": 0.6,
      "target_bleu": 0.4,
      "target_rouge": 0.5,
      "target_ruby": 0.3,
      "eval_batch_size": 8,
      "eval_samples": 50,
      "eval_datasets": [
        "T2C-CONALA-CODEGEN-FINETUNED-SO.csv",
        "T2C-CONALA-CODEGEN-VANILLA.csv",
        "T2C-CONALA-CODEGEN2B-FINETUNED-CONALA-IMPORTS.csv"
      ],
      "use_cached_embeddings": true,
      "cache_embeddings": true,
      "embedding_model": "microsoft/codebert-base"
    },
    "data": {
      "train_data_path": "./datasets_for_training",
      "eval_data_path": "./datasets_for_eval",
      "human_feedback_path": "./evaluation_results_server",
      "output_path": "./modern_outputs",
      "conala_local_path": "C:\\Users\\\u041f\u043e\u043b\u0438\u043d\u0430\\Desktop\\\u0420\u0430\u0431\u043e\u0442\u0430\\huawei\\rlhf\\conala-corpus",
      "max_train_samples": 10000,
      "max_eval_samples": 1000,
      "train_test_split": 0.9,
      "use_data_augmentation": true,
      "augmentation_ratio": 0.1,
      "min_prompt_length": 0,
      "max_prompt_length": 512,
      "min_response_length": 0,
      "max_response_length": 512
    },
    "hardware": {
      "device": "cpu",
      "mixed_precision": true,
      "gradient_checkpointing": true,
      "max_memory_usage": 0.9,
      "offload_to_cpu": false,
      "use_deepspeed": false,
      "local_rank": -1,
      "world_size": 1,
      "ddp_backend": "nccl"
    },
    "seed": 42,
    "debug": false,
    "verbose": true,
    "experiment_name": "modern_rlhf_experiment",
    "run_name": "modern_rlhf_experiment_20251030_160304",
    "tags": [
      "research",
      "experimental"
    ]
  },
  "reward_model_metrics": {
    "training_time": 90.89734268188477
  },
  "training_metrics": {
    "avg_reward": 0.678864711523056,
    "reward_std": 0.03819506654396962,
    "eval_bertscore": 0.8114044070243835,
    "eval_codebleu": 0.0,
    "eval_bleu": 0.011600739750730288,
    "eval_rouge": 0.11750699575932914,
    "eval_ruby": 0.12000000000000004
  },
  "evaluation_metrics": {
    "bertscore": 0.8184431195259094,
    "codebleu": 0.0,
    "bleu": 0.011885545559345985,
    "rouge": 0.13758486418174556,
    "ruby": 0.12400000000000003,
    "targets_met": {
      "bertscore": true,
      "codebleu": false,
      "bleu": false,
      "rouge": false,
      "ruby": false
    }
  },
  "final_metrics": {
    "all_targets_met": false,
    "targets_met_count": 1,
    "targets_total": 5,
    "success_score": 0.2
  },
  "training_time": 265.5694725513458,
  "total_time": 468.2822992801666,
  "success": true,
  "error_message": null,
  "timestamp": "2025-10-30T16:10:52.303559"
}